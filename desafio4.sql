SELECT J.JOB_TITLE AS Cargo,
(SELECT CAST(AVG(SALARY) AS DECIMAL(10,2)) FROM hr.employees AS E
WHERE J.JOB_ID = E.JOB_ID) AS 'Média salarial',
CASE
WHEN (SELECT AVG(SALARY) FROM hr.employees as E
WHERE J.JOB_ID = E.JOB_ID) BETWEEN 2000 AND 5800  THEN 'Júnior'

WHEN (SELECT AVG(SALARY) FROM hr.employees as E
WHERE J.JOB_ID = E.JOB_ID) BETWEEN 5801 AND 7500  THEN 'Pleno'

WHEN (SELECT AVG(SALARY) FROM hr.employees as E
WHERE J.JOB_ID = E.JOB_ID) BETWEEN 7501 AND 10500  THEN 'Sênior'

WHEN (SELECT AVG(SALARY) FROM hr.employees as E
WHERE J.JOB_ID = E.JOB_ID) > 10500  THEN 'CEO'
END AS Senioridade
FROM hr.jobs AS J ORDER BY 2, 3 asc;
